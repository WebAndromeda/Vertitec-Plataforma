{% extends 'layouts/navbar.html' %}
{% block content %}
<center>
    <h1 class="infoTable mt-3">
        ¬°Hola {{ user.first_name }} {{ user.last_name }}! Bienvenido de nuevo - Rol: {{ user.groups.all.0.name|default:"Sin Rol" }}
    </h1>

    <div class="container-fluid container_content">
        <div class="container_form">
            <h1 class="titleText">
                Formulario para {% if update %}editar{% else %}crear{% endif %} un usuario
            </h1>
            
            {% if error_message %}
                <p style="color: red; font-weight: bold;">{{ error_message }}</p>
            {% endif %}

            <!-- üîπ Mostrar errores generales del formulario (como contrase√±as no coinciden) -->
            {% if form.non_field_errors %}
                <div style="color: red; margin-bottom: 10px;">
                    {% for error in form.non_field_errors %}
                        <p>{{ error }}</p>
                    {% endfor %}
                </div>
            {% endif %}

            <form action="" method="post">
                {% csrf_token %}
                <div class="row">
                    <div class="col-6">
                        <label class="labelInputs">Nombre de usuario</label><br>
                        {{ form.username }}
                        {{ form.username.errors }}<br><br>

                        <label class="labelInputs">Apellido</label><br>
                        {{ form.last_name }}
                        {{ form.last_name.errors }}<br><br>

                        <label class="labelInputs">
                            Confirmaci√≥n de contrase√±a {% if update %}(Opcional){% endif %}
                        </label><br>
                        {{ form.password2 }}
                        {{ form.password2.errors }}<br><br>

                    </div>

                    <div class="col-6">
                        <label class="labelInputs">Nombre</label><br>
                        {{ form.first_name }}
                        {{ form.first_name.errors }}<br><br>

                        <label class="labelInputs">
                            Contrase√±a {% if update %}(Opcional){% endif %}
                        </label><br>
                        {{ form.password1 }}
                        {{ form.password1.errors }}<br><br>

                        {% if update %}
                            <p class="labelInputs">Recuerda que no puedes cambiar el perfil de un usuario</p>
                        {% else %}
                            <label class="labelInputs">Rol (Despu√©s no podr√°s cambiarlo)</label><br>
                            {{ form.role }}
                            {{ form.role.errors }}<br><br>
                        {% endif %}
                    </div>
                </div>

                <button class="buttonSendForm" type="submit">
                    {% if update %}Editar{% else %}Crear{% endif %} usuario
                </button><br><br>
            </form>
        </div>
    </div>
</center>
{% endblock %}
